# ğŸš€ ResNet18 å›¾åƒåˆ†ç±»è®­ç»ƒå™¨

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.2.2-red.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Status](https://img.shields.io/badge/Status-Active-success.svg)

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ˜“äºä½¿ç”¨çš„ ResNet18 å›¾åƒåˆ†ç±»è®­ç»ƒå·¥å…·åŒ…

[åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—) â€¢ [é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åŸºäº ResNet18 çš„å›¾åƒåˆ†ç±»è®­ç»ƒæµç¨‹ï¼Œæ”¯æŒä»æ•°æ®å‡†å¤‡ã€æ•°æ®å¢å¼ºã€æ¨¡å‹è®­ç»ƒåˆ°å•å›¾æµ‹è¯•çš„å…¨æµç¨‹ã€‚é¡¹ç›®ä»£ç ç®€æ´æ˜“æ‡‚ï¼Œé€‚åˆæ·±åº¦å­¦ä¹ åˆå­¦è€…å­¦ä¹ å’Œä½¿ç”¨ã€‚

### âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **åŒæ¨¡å¼è®­ç»ƒ**ï¼šæ”¯æŒä»é›¶è®­ç»ƒå’Œè¿ç§»å­¦ä¹ ä¸¤ç§è®­ç»ƒæ¨¡å¼
- ğŸ“Š **æ•°æ®åˆ†æ**ï¼šæä¾›æ•°æ®é›†åˆ†æå·¥å…·ï¼Œå¯è§†åŒ–æ•°æ®åˆ†å¸ƒå’Œå›¾åƒå°ºå¯¸
- ğŸ”„ **æ•°æ®å¢å¼º**ï¼šæ”¯æŒæ°´å¹³ç¿»è½¬ã€å‚ç›´ç¿»è½¬ç­‰æ•°æ®å¢å¼ºæ–¹æ³•
- âš–ï¸ **æ•°æ®å¹³è¡¡**ï¼šè‡ªåŠ¨å¹³è¡¡å„ç±»åˆ«æ ·æœ¬æ•°é‡
- ğŸ§¹ **æ•°æ®è¿‡æ»¤**ï¼šè¿‡æ»¤ä¸ç¬¦åˆå°ºå¯¸è¦æ±‚çš„å›¾åƒ
- ğŸ“ˆ **è®­ç»ƒç›‘æ§**ï¼šå®æ—¶è¾“å‡ºè®­ç»ƒæŸå¤±å’ŒéªŒè¯å‡†ç¡®ç‡
- ğŸ’¾ **æ¨¡å‹ä¿å­˜**ï¼šè‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹å’Œå®šæœŸæ£€æŸ¥ç‚¹
- ğŸ” **å•å›¾æµ‹è¯•**ï¼šæ”¯æŒå¯¹å•å¼ å›¾ç‰‡è¿›è¡Œé¢„æµ‹

---

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

### ä¾èµ–åº“

```
Python >= 3.8
PyTorch >= 2.2.2 (CUDA 12.1)
torchvision >= 0.17.2
Pillow >= 10.3.0
matplotlib >= 3.8.4
numpy >= 1.26.4
tqdm >= 4.66.2
opencv-python (ç”¨äºæ•°æ®å¢å¼º)
```

### ç¡¬ä»¶è¦æ±‚

- **æ¨è**ï¼šNVIDIA GPU (8GB+ æ˜¾å­˜)
- **æœ€ä½**ï¼šCPU (è®­ç»ƒé€Ÿåº¦è¾ƒæ…¢)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/RFalcon-Mick/resnet18_trainer.git
cd resnet18_trainer
```

### 2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 3. åˆå§‹åŒ–é¡¹ç›®

```bash
python setup.py
```

è¿™å°†åˆ›å»º `dataset` å’Œ `output` ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚

### 4. å‡†å¤‡æ•°æ®é›†

å°†æ‚¨çš„å›¾åƒæ•°æ®æŒ‰ä»¥ä¸‹ç»“æ„ç»„ç»‡ï¼š

```
dataset/
â”œâ”€â”€ ç±»åˆ«1/
â”‚   â”œâ”€â”€ image1.jpg
â”‚   â”œâ”€â”€ image2.jpg
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ç±»åˆ«2/
â”‚   â”œâ”€â”€ image1.jpg
â”‚   â”œâ”€â”€ image2.jpg
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

### 5. ç”Ÿæˆè®­ç»ƒ/æµ‹è¯•é›†

```bash
python ge_dataset.py
```

è¿™å°†è‡ªåŠ¨ç”Ÿæˆ `train.txt` å’Œ `test.txt` æ–‡ä»¶ï¼ˆé»˜è®¤è®­ç»ƒé›†å  90%ï¼‰ã€‚

### 6. å¼€å§‹è®­ç»ƒ

**ä»é›¶è®­ç»ƒ**ï¼š
```bash
python resnet18.py
```

**è¿ç§»å­¦ä¹ ï¼ˆæ¨èï¼‰**ï¼š
```bash
python pretrained_resnet18.py
```

---

## ğŸ“š ä½¿ç”¨æŒ‡å—

### æ•°æ®å‡†å¤‡å·¥å…·

#### 1ï¸âƒ£ æ•°æ®åˆ†æ (`data_info.py`)

åˆ†ææ•°æ®é›†çš„åˆ†å¸ƒæƒ…å†µå’Œå›¾åƒå°ºå¯¸ï¼š

```bash
python data_info.py
```

**åŠŸèƒ½**ï¼š
- ç”Ÿæˆæ•°æ®åˆ†å¸ƒæ¡å½¢å›¾
- ç”Ÿæˆå›¾åƒå°ºå¯¸æ•£ç‚¹å›¾
- è®¡ç®—å„ç±»åˆ«å¹³å‡æ ·æœ¬æ•°

#### 2ï¸âƒ£ æ•°æ®è¿‡æ»¤ (`data_filter.py`)

è¿‡æ»¤ä¸ç¬¦åˆè¦æ±‚çš„å›¾åƒï¼š

```bash
python data_filter.py
```

**å¯é…ç½®å‚æ•°**ï¼š
- `min`ï¼šæœ€å°è¾¹é•¿ï¼ˆé»˜è®¤ 200pxï¼‰
- `max`ï¼šæœ€å¤§è¾¹é•¿ï¼ˆé»˜è®¤ 2000pxï¼‰
- `ratio`ï¼šæœ€å°é•¿å®½æ¯”ï¼ˆé»˜è®¤ 0.5ï¼‰

#### 3ï¸âƒ£ æ•°æ®å¢å¼º (`data_argumentaion.py`)

å¯¹æ ·æœ¬é‡ä¸è¶³çš„ç±»åˆ«è¿›è¡Œæ•°æ®å¢å¼ºï¼š

```bash
python data_argumentaion.py
```

**åŠŸèƒ½**ï¼š
- å¯¹æ ·æœ¬æ•° < é˜ˆå€¼çš„ç±»åˆ«è¿›è¡Œç¿»è½¬å¢å¼º
- ç”Ÿæˆå¢å¼ºåçš„æ•°æ®é›†åˆ° `enhance_dataset` æ–‡ä»¶å¤¹
- ä¿æŒåŸå§‹æ•°æ®ä¸å˜

**å¯é…ç½®å‚æ•°**ï¼š
- `threshold`ï¼šæ•°æ®å¢å¼ºé˜ˆå€¼ï¼ˆé»˜è®¤ 200ï¼‰

#### 4ï¸âƒ£ æ•°æ®å¹³è¡¡ (`data_balance.py`)

åˆ é™¤æ ·æœ¬é‡è¿‡å¤šçš„æ•°æ®ï¼š

```bash
python data_balance.py
```

**å¯é…ç½®å‚æ•°**ï¼š
- `threshold`ï¼šæœ€å¤§æ ·æœ¬æ•°ï¼ˆé»˜è®¤ 300ï¼‰
- `img_root`ï¼šæ•°æ®é›†è·¯å¾„

#### 5ï¸âƒ£ æ•°æ®å½’ä¸€åŒ– (`data_normalization.py`)

è®¡ç®—æ•°æ®é›†çš„å‡å€¼å’Œæ ‡å‡†å·®ï¼š

```bash
python data_normalization.py
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```python
mean = [0.522, 0.485, 0.426]
std = [0.205, 0.202, 0.207]
```

å°†è¾“å‡ºçš„å€¼æ›´æ–°åˆ° `utils.py` å’Œ `single_picture_test.py` ä¸­çš„ `transform_BZ`ã€‚

### è®­ç»ƒæ¨¡å‹

#### æ–¹å¼ä¸€ï¼šä»é›¶è®­ç»ƒ (`resnet18.py`)

```bash
python resnet18.py
```

**ç‰¹ç‚¹**ï¼š
- éšæœºåˆå§‹åŒ–æ¨¡å‹å‚æ•°
- é€‚åˆå¤§è§„æ¨¡æ•°æ®é›†
- è®­ç»ƒæ—¶é—´è¾ƒé•¿

**å¯é…ç½®å‚æ•°**ï¼š
```python
batch_size = 5          # æ‰¹æ¬¡å¤§å°
classes = 55            # åˆ†ç±»æ•°é‡
learning_rate = 1e-3    # å­¦ä¹ ç‡
epochs = 500            # è®­ç»ƒè½®æ•°
```

#### æ–¹å¼äºŒï¼šè¿ç§»å­¦ä¹  (`pretrained_resnet18.py`)

```bash
python pretrained_resnet18.py
```

**ç‰¹ç‚¹**ï¼š
- ä½¿ç”¨ ImageNet é¢„è®­ç»ƒæƒé‡
- é€‚åˆä¸­å°è§„æ¨¡æ•°æ®é›†
- æ”¶æ•›é€Ÿåº¦å¿«ï¼Œæ•ˆæœæ›´å¥½

**å¯é…ç½®å‚æ•°**ï¼š
```python
batch_size = 32         # æ‰¹æ¬¡å¤§å°
classes = 55            # åˆ†ç±»æ•°é‡
learning_rate = 1e-4    # å­¦ä¹ ç‡
epochs = 50             # è®­ç»ƒè½®æ•°
```

**è®­ç»ƒè¾“å‡º**ï¼š

æ¨¡å‹å’Œè®­ç»ƒè®°å½•å°†ä¿å­˜åˆ° `output` æ–‡ä»¶å¤¹ï¼š
- `resnet18_*.pth`ï¼šæ¨¡å‹æ£€æŸ¥ç‚¹
- `resnet18_*_best.pth`ï¼šæœ€ä½³æ¨¡å‹
- `resnet18_*_last.pth`ï¼šæœ€åä¸€ä¸ª epoch çš„æ¨¡å‹
- `resnet18_*.txt`ï¼šè®­ç»ƒæ—¥å¿—

### æ¨¡å‹æµ‹è¯•

#### å•å›¾æµ‹è¯• (`single_picture_test.py`)

å¯¹å•å¼ å›¾ç‰‡è¿›è¡Œé¢„æµ‹ï¼š

```bash
python single_picture_test.py
```

**ä½¿ç”¨æ­¥éª¤**ï¼š

1. ä¿®æ”¹é…ç½®å‚æ•°ï¼š
```python
img_path = r'path/to/your/image.jpg'  # å›¾ç‰‡è·¯å¾„
classes = 55                           # åˆ†ç±»æ•°é‡
model_path = r"output/resnet18_e_best.pth"  # æ¨¡å‹è·¯å¾„
```

2. è¿è¡Œè„šæœ¬è·å–é¢„æµ‹ç»“æœ

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
resnet18_trainer/
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ LICENSE                      # MIT å¼€æºåè®®
â”œâ”€â”€ requirements.txt             # ä¾èµ–åº“æ¸…å•
â”œâ”€â”€ setup.py                     # é¡¹ç›®åˆå§‹åŒ–è„šæœ¬
â”‚
â”œâ”€â”€ æ•°æ®å‡†å¤‡
â”‚   â”œâ”€â”€ ge_dataset.py           # ç”Ÿæˆè®­ç»ƒ/æµ‹è¯•é›†åˆ’åˆ†
â”‚   â”œâ”€â”€ data_info.py            # æ•°æ®åˆ†æå’Œå¯è§†åŒ–
â”‚   â”œâ”€â”€ data_filter.py          # æ•°æ®è¿‡æ»¤
â”‚   â”œâ”€â”€ data_argumentaion.py    # æ•°æ®å¢å¼º
â”‚   â”œâ”€â”€ data_balance.py         # æ•°æ®å¹³è¡¡
â”‚   â””â”€â”€ data_normalization.py   # è®¡ç®—å½’ä¸€åŒ–å‚æ•°
â”‚
â”œâ”€â”€ æ¨¡å‹è®­ç»ƒ
â”‚   â”œâ”€â”€ resnet18.py             # ä»é›¶è®­ç»ƒ
â”‚   â”œâ”€â”€ pretrained_resnet18.py  # è¿ç§»å­¦ä¹ è®­ç»ƒ
â”‚   â””â”€â”€ utils.py                # æ•°æ®åŠ è½½å’Œå·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ æ¨¡å‹æµ‹è¯•
â”‚   â””â”€â”€ single_picture_test.py  # å•å›¾é¢„æµ‹
â”‚
â””â”€â”€ å·¥ä½œç›®å½•
    â”œâ”€â”€ dataset/                # åŸå§‹æ•°æ®é›†
    â”œâ”€â”€ enhance_dataset/        # å¢å¼ºåæ•°æ®é›†
    â”œâ”€â”€ output/                 # è®­ç»ƒè¾“å‡ºï¼ˆæ¨¡å‹å’Œæ—¥å¿—ï¼‰
    â”œâ”€â”€ train.txt               # è®­ç»ƒé›†åˆ—è¡¨
    â””â”€â”€ test.txt                # æµ‹è¯•é›†åˆ—è¡¨
```

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

```mermaid
graph LR
    A[å‡†å¤‡æ•°æ®é›†] --> B[æ•°æ®åˆ†æ]
    B --> C[æ•°æ®è¿‡æ»¤]
    C --> D[æ•°æ®å¢å¼º]
    D --> E[æ•°æ®å¹³è¡¡]
    E --> F[è®¡ç®—å½’ä¸€åŒ–å‚æ•°]
    F --> G[ç”Ÿæˆè®­ç»ƒ/æµ‹è¯•é›†]
    G --> H[æ¨¡å‹è®­ç»ƒ]
    H --> I[æ¨¡å‹æµ‹è¯•]
```

### æ¨èæµç¨‹

1. **æ•°æ®å‡†å¤‡é˜¶æ®µ**
   ```bash
   python setup.py                    # åˆå§‹åŒ–æ–‡ä»¶å¤¹
   # å°†æ•°æ®æ”¾å…¥ dataset/ æ–‡ä»¶å¤¹
   python data_info.py                # åˆ†ææ•°æ®
   python data_filter.py              # è¿‡æ»¤æ•°æ®
   python data_argumentaion.py        # æ•°æ®å¢å¼º
   python data_balance.py             # æ•°æ®å¹³è¡¡
   python data_normalization.py       # è®¡ç®—å½’ä¸€åŒ–å‚æ•°
   # æ›´æ–° utils.py ä¸­çš„å½’ä¸€åŒ–å‚æ•°
   ```

2. **è®­ç»ƒé˜¶æ®µ**
   ```bash
   python ge_dataset.py               # ç”Ÿæˆæ•°æ®é›†åˆ’åˆ†
   python pretrained_resnet18.py      # å¼€å§‹è®­ç»ƒï¼ˆæ¨èè¿ç§»å­¦ä¹ ï¼‰
   ```

3. **æµ‹è¯•é˜¶æ®µ**
   ```bash
   python single_picture_test.py      # å•å›¾æµ‹è¯•
   ```

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. æé«˜è®­ç»ƒæ•ˆæœ

- âœ… ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼ˆ`pretrained_resnet18.py`ï¼‰é€šå¸¸æ•ˆæœæ›´å¥½
- âœ… ç¡®ä¿æ•°æ®é›†å„ç±»åˆ«æ ·æœ¬é‡å‡è¡¡
- âœ… é€‚å½“è°ƒæ•´å­¦ä¹ ç‡å’Œæ‰¹æ¬¡å¤§å°
- âœ… ä½¿ç”¨æ•°æ®å¢å¼ºå¢åŠ æ ·æœ¬å¤šæ ·æ€§

### 2. è§£å†³å¸¸è§é—®é¢˜

**æ˜¾å­˜ä¸è¶³**ï¼š
```python
# å‡å° batch_size
batch_size = 8  # æˆ–æ›´å°

# å‡å° num_workers
num_workers = 0  # æˆ–æ›´å°
```

**è®­ç»ƒé€Ÿåº¦æ…¢**ï¼š
```python
# å¢åŠ  num_workersï¼ˆCPUï¼‰
num_workers = 8  # æ ¹æ® CPU æ ¸å¿ƒæ•°è°ƒæ•´

# ä½¿ç”¨ pin_memoryï¼ˆGPUï¼‰
pin_memory = True
```

**è¿‡æ‹Ÿåˆ**ï¼š
- å¢åŠ æ•°æ®å¢å¼º
- å‡å°‘è®­ç»ƒè½®æ•°
- ä½¿ç”¨æ­£åˆ™åŒ–æ–¹æ³•

### 3. è‡ªå®šä¹‰ä¿®æ”¹

**ä¿®æ”¹åˆ†ç±»æ•°é‡**ï¼š
```python
# åœ¨è®­ç»ƒè„šæœ¬ä¸­ä¿®æ”¹
classes = ä½ çš„ç±»åˆ«æ•°
```

**ä¿®æ”¹å›¾åƒå°ºå¯¸**ï¼š
```python
# åœ¨ utils.py ä¸­ä¿®æ”¹
self.img_size = 512  # æ”¹ä¸ºä½ éœ€è¦çš„å°ºå¯¸
```

**ä¿®æ”¹è®­ç»ƒ/æµ‹è¯•æ¯”ä¾‹**ï¼š
```python
# åœ¨ ge_dataset.py ä¸­ä¿®æ”¹
train_ratio = 0.9  # æ”¹ä¸ºä½ éœ€è¦çš„æ¯”ä¾‹
```

---

## ğŸ“Š è®­ç»ƒç›‘æ§

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šå®æ—¶è¾“å‡ºä»¥ä¸‹ä¿¡æ¯ï¼š

```
Epoch 1
-------------------------------
loss: 3.912345  [    0/  5000]
loss: 3.123456  [   50/  5000]
...
train time: 120.5
correct = 0.75, Test Error:
 Accuracy: 75.0%, Avg loss: 0.851234

Epoch 2
-------------------------------
...
```

è®­ç»ƒæ—¥å¿—ä¿å­˜æ ¼å¼ï¼ˆ`output/resnet18_*.txt`ï¼‰ï¼š

```
epoch    1    train_loss    0.123    val_loss    0.456    val_accuracy    0.789
epoch    2    train_loss    0.098    val_loss    0.432    val_accuracy    0.812
...
```

---

## ğŸ“ å­¦ä¹ èµ„æº

- [PyTorch å®˜æ–¹æ–‡æ¡£](https://pytorch.org/docs/stable/index.html)
- [ResNet è®ºæ–‡](https://arxiv.org/abs/1512.03385)
- [å›¾åƒåˆ†ç±»å…¥é—¨æ•™ç¨‹](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html)
- [è¿ç§»å­¦ä¹ æŒ‡å—](https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html)

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ Star æ”¯æŒä¸€ä¸‹ï¼

---

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

---

## ğŸ‘¨â€ğŸ’» ä½œè€…

**RFalcon**

---

## ğŸ“® è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤ [Issue](https://github.com/RFalcon-Mick/resnet18_trainer/issues)
- å‘èµ· [Pull Request](https://github.com/RFalcon-Mick/resnet18_trainer/pulls)

---

<div align="center">

**å¦‚æœè§‰å¾—é¡¹ç›®ä¸é”™ï¼Œè¯·ç‚¹ä¸ª â­ Star æ”¯æŒä¸€ä¸‹ï¼**

Made with â¤ï¸ by RFalcon

</div>
